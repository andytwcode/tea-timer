# timer-control

## Purpose

定義計時器控制功能的規格，包含開始、重置按鈕和狀態管理。
## Requirements
### Requirement: 提供開始按鈕
系統 SHALL 提供開始按鈕，並根據當前模式、狀態和泡數動態調整按鈕文字。

#### Scenario: 單次模式初始狀態
- **WHEN** 連續沖泡模式未啟用且尚未開始倒數
- **THEN** 開始按鈕顯示「開始」

#### Scenario: 連續模式初始狀態
- **WHEN** 連續沖泡模式啟用且泡數為 1
- **THEN** 開始按鈕顯示「開始第 1 泡」

#### Scenario: 連續模式完成後增量為零
- **WHEN** 連續沖泡模式啟用、增量為 0、且第 3 泡完成
- **THEN** 開始按鈕顯示「重新開始」

#### Scenario: 連續模式完成後增量大於零
- **WHEN** 連續沖泡模式啟用、增量大於 0、且第 2 泡完成
- **THEN** 開始按鈕顯示「開始第 3 泡 (X秒)」，其中 X 為第 3 泡的總秒數

#### Scenario: 倒數進行中按鈕文字
- **WHEN** 第 4 泡倒數正在進行
- **THEN** 開始按鈕顯示「第 4 泡計時中」且為禁用狀態

#### Scenario: 點擊開始下一泡
- **WHEN** 第 5 泡完成後使用者點擊「開始第 6 泡」按鈕
- **THEN** 系統開始第 6 泡的倒數計時

### Requirement: 提供重置按鈕
系統 SHALL 提供「重置」按鈕，在連續沖泡模式下同時重置泡數計數器。

#### Scenario: 倒數進行中點擊重置
- **WHEN** 第 3 泡倒數正在進行且使用者點擊「重置」按鈕
- **THEN** 系統停止倒數
- **AND** 泡數計數器重置為 1
- **AND** 顯示時間恢復為第一泡的初始輸入時間

#### Scenario: 倒數結束後點擊重置
- **WHEN** 第 8 泡倒數已結束且使用者點擊「重置」按鈕
- **THEN** 泡數計數器重置為 1
- **AND** 顯示時間恢復為第一泡的初始輸入時間

#### Scenario: 未開始倒數時點擊重置
- **WHEN** 尚未開始倒數且使用者點擊「重置」按鈕
- **THEN** 泡數計數器保持為 1
- **AND** 顯示時間保持為第一泡的初始輸入時間

### Requirement: 開始按鈕在倒數中禁用
系統 SHALL 在倒數進行期間將主按鈕改為「暫停」功能，允許使用者暫停計時。暫停後按鈕變為「繼續」，可恢復計時。

#### Scenario: 倒數進行中主按鈕顯示暫停
- **WHEN** 任一泡倒數正在進行
- **THEN** 主按鈕為可點擊狀態
- **AND** 按鈕文字顯示「⏸ 暫停」或「⏸ 暫停第 X 泡」（連續沖泡模式）

#### Scenario: 點擊暫停按鈕
- **WHEN** 倒數進行中使用者點擊主按鈕
- **THEN** 系統暫停計時
- **AND** 保留當前剩餘秒數
- **AND** 主按鈕文字變為「▶ 繼續」或「▶ 繼續第 X 泡」

#### Scenario: 已暫停時主按鈕顯示繼續
- **WHEN** 計時器處於暫停狀態
- **THEN** 主按鈕為可點擊狀態
- **AND** 按鈕文字顯示「▶ 繼續」或「▶ 繼續第 X 泡」（連續沖泡模式）

#### Scenario: 點擊繼續按鈕
- **WHEN** 暫停中使用者點擊主按鈕
- **THEN** 系統從當前剩餘秒數恢復計時
- **AND** 主按鈕文字變為「⏸ 暫停」或「⏸ 暫停第 X 泡」

#### Scenario: 倒數停止或重置後主按鈕啟用
- **WHEN** 倒數結束或使用者點擊重置
- **THEN** 主按鈕恢復為開始狀態
- **AND** 按鈕文字根據當前狀態更新（如「▶ 開始」或「▶ 開始第 X 泡」）

### Requirement: 驗證輸入後才啟動倒數
系統 SHALL 在使用者點擊「開始」時先驗證第一泡的輸入時間，僅在有效時才啟動倒數。啟動後若通知權限已授予，系統將在倒數完成時發送系統通知。

#### Scenario: 有效輸入啟動倒數
- **WHEN** 使用者輸入第一泡時間為 3 分鐘 0 秒並點擊「開始」
- **THEN** 系統驗證通過，開始倒數

#### Scenario: 無效輸入不啟動倒數
- **WHEN** 使用者輸入第一泡時間為 0 分鐘 2 秒（總計 2 秒，少於 5 秒）並點擊「開始」
- **THEN** 系統驗證失敗，不啟動倒數，顯示錯誤訊息

#### Scenario: 倒數完成時觸發通知
- **WHEN** 倒數計時達到 0 秒且通知權限已授予
- **THEN** 系統停止倒數並發送系統通知
- **AND** 通知內容依據單泡或連續沖泡模式顯示

#### Scenario: 倒數完成但無通知權限
- **WHEN** 倒數計時達到 0 秒但通知權限未授予或被拒絕
- **THEN** 系統停止倒數，不發送通知，其他功能正常運作

### Requirement: 提供結束沖泡按鈕
系統 SHALL 在連續沖泡模式下，當倒數完成且增量大於 0 時，提供「結束沖泡」次按鈕。

#### Scenario: 完成後顯示結束沖泡按鈕
- **WHEN** 連續沖泡模式啟用、增量大於 0、且第 2 泡完成
- **THEN** 系統顯示「結束沖泡」次按鈕

#### Scenario: 點擊結束沖泡
- **WHEN** 第 5 泡完成後使用者點擊「結束沖泡」按鈕
- **THEN** 系統重置為初始狀態
- **AND** 泡數計數器重置為 1

#### Scenario: 單次模式下不顯示結束沖泡
- **WHEN** 連續沖泡模式未啟用
- **THEN** 系統不顯示「結束沖泡」按鈕

#### Scenario: 增量為零時不顯示結束沖泡
- **WHEN** 連續沖泡模式啟用但增量為 0
- **THEN** 系統不顯示「結束沖泡」按鈕

### Requirement: 暫停期間保持輸入鎖定
系統 SHALL 在暫停期間保持時間輸入框為鎖定狀態，不允許修改時間。

#### Scenario: 暫停時輸入框保持禁用
- **WHEN** 計時器處於暫停狀態
- **THEN** 分鐘和秒數輸入框為禁用狀態
- **AND** 無法修改輸入值

#### Scenario: 繼續後輸入框仍然鎖定
- **WHEN** 從暫停狀態恢復計時
- **THEN** 分鐘和秒數輸入框保持禁用狀態（與計時中相同）

### Requirement: 暫停時停止計時器執行
系統 SHALL 在暫停時清除計時器 interval，停止背景倒數。繼續時重新建立 interval。

#### Scenario: 暫停時清除 interval
- **WHEN** 使用者點擊暫停
- **THEN** 系統執行 clearInterval() 清除計時器
- **AND** 剩餘秒數不再遞減
- **AND** 不執行任何背景計時邏輯

#### Scenario: 繼續時重新啟動 interval
- **WHEN** 使用者點擊繼續
- **THEN** 系統重新建立 setInterval()
- **AND** 從當前剩餘秒數開始倒數

#### Scenario: 重置時清除暫停狀態
- **WHEN** 暫停中使用者點擊重置按鈕
- **THEN** 系統清除 interval（若存在）
- **AND** 清除暫停狀態
- **AND** 恢復為初始狀態

### Requirement: 連續沖泡模式下暫停僅影響當前泡
系統 SHALL 在連續沖泡模式下，暫停僅影響當前正在計時的泡，不改變基準時間或後續泡的預計時間。

#### Scenario: 暫停不改變基準時間
- **WHEN** 第 3 泡計時中暫停
- **THEN** 第一泡基準時間不變
- **AND** 增量設定不變

#### Scenario: 暫停不影響下一泡時間
- **WHEN** 第 3 泡計時中暫停後繼續，並完成計時
- **THEN** 第 4 泡的預計時間仍按原公式計算（基準 + 3 × 增量）
- **AND** 不受第 3 泡暫停時長影響

#### Scenario: 暫停期間「開始下一泡」按鈕行為不變
- **WHEN** 第 2 泡完成後暫停（若可能）
- **THEN** 「開始第 3 泡」按鈕邏輯不變
- **AND** 點擊後從第 3 泡的預計時間開始計時

### Requirement: 暫停狀態顯示在標題列
系統 SHALL 在瀏覽器標題列顯示暫停狀態，提醒使用者當前有計時器暫停中。

#### Scenario: 暫停時標題列顯示暫停圖示
- **WHEN** 使用者點擊暫停
- **THEN** 瀏覽器標題更新為「⏸ 2:30 - 泡茶計時器」（顯示剩餘時間和暫停圖示）

#### Scenario: 繼續時標題列恢復倒數
- **WHEN** 使用者點擊繼續
- **THEN** 瀏覽器標題恢復為倒數格式「2:29 - 泡茶計時器」

#### Scenario: 連續沖泡模式暫停時標題包含泡數
- **WHEN** 連續沖泡模式第 3 泡暫停
- **THEN** 瀏覽器標題顯示「⏸ 2:30 - 第 3 泡 - 泡茶計時器」

