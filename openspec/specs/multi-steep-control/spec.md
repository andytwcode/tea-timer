# multi-steep-control

## Purpose

定義連續沖泡控制功能的規格，包含模式開關、增量時間設定和多泡操作流程。

## Requirements

### Requirement: 使用者可啟用連續沖泡模式
系統 SHALL 提供一個勾選框，讓使用者選擇是否啟用連續沖泡模式。

#### Scenario: 勾選連續沖泡模式
- **WHEN** 使用者勾選「啟用連續沖泡」勾選框
- **THEN** 系統顯示增量時間輸入欄位

#### Scenario: 取消勾選連續沖泡模式
- **WHEN** 使用者取消勾選「啟用連續沖泡」勾選框
- **THEN** 系統隱藏增量時間輸入欄位

### Requirement: 使用者可設定每泡增量時間
系統 SHALL 提供分鐘和秒數輸入欄位，讓使用者設定每泡的時間增量。

#### Scenario: 輸入有效的增量時間
- **WHEN** 使用者在增量欄位輸入「分鐘: 1, 秒: 30」
- **THEN** 系統接受此設定，後續每泡將比前一泡增加 90 秒

#### Scenario: 分鐘超過範圍
- **WHEN** 使用者輸入增量分鐘大於 10
- **THEN** 系統自動調整為 10

#### Scenario: 秒數超過範圍
- **WHEN** 使用者輸入增量秒數大於 59
- **THEN** 系統自動調整為 59

#### Scenario: 負數輸入
- **WHEN** 使用者輸入負數
- **THEN** 系統自動調整為 0

### Requirement: 增量為零時等同單次模式
當連續沖泡啟用但增量為 0 時，系統 SHALL 行為等同於單次模式。

#### Scenario: 啟用連續但增量為零
- **WHEN** 使用者啟用連續沖泡且增量時間為「分鐘: 0, 秒: 0」
- **THEN** 系統每泡使用相同的第一泡時間
- **AND** 開始按鈕顯示「開始第 X 泡」
- **AND** 完成後按鈕顯示「重新開始」而非「開始第 X 泡」

### Requirement: 完成後提示下一泡操作
當連續沖泡啟用且增量大於 0 時，系統 SHALL 在每泡完成後顯示下一泡的操作選項。

#### Scenario: 完成一泡後顯示下一泡選項
- **WHEN** 第 1 泡倒數完成
- **THEN** 主按鈕文字變更為「開始第 2 泡 (X秒)」，其中 X 為第 2 泡的總秒數
- **AND** 顯示「結束沖泡」次按鈕

#### Scenario: 點擊開始下一泡
- **WHEN** 第 1 泡完成後使用者點擊「開始第 2 泡」按鈕
- **THEN** 系統開始第 2 泡的倒數計時
- **AND** 泡數計數器增加為 2

#### Scenario: 點擊結束沖泡
- **WHEN** 第 1 泡完成後使用者點擊「結束沖泡」按鈕
- **THEN** 系統重置為初始狀態
- **AND** 泡數計數器重置為 1

### Requirement: 重置按鈕應清除所有狀態
重置按鈕 SHALL 將計時器和泡數狀態恢復到初始值。

#### Scenario: 倒數中點擊重置
- **WHEN** 第 3 泡倒數進行中時使用者點擊「重置」按鈕
- **THEN** 系統停止倒數
- **AND** 泡數計數器重置為 1
- **AND** 計時器顯示第一泡的初始時間

#### Scenario: 完成後點擊重置
- **WHEN** 第 5 泡完成後使用者點擊「重置」按鈕
- **THEN** 泡數計數器重置為 1
- **AND** 計時器顯示第一泡的初始時間
- **AND** 次按鈕「結束沖泡」消失

### Requirement: 使用者可展開或收起增量設定區域
系統 SHALL 提供展開/收起按鈕，讓使用者控制增量設定區域的顯示狀態。

#### Scenario: 點擊展開增量設定
- **WHEN** 增量設定區域為收起狀態且使用者點擊「⚙️ 設定增量」按鈕
- **THEN** 系統展開增量設定區域，顯示分鐘和秒數輸入欄位
- **AND** 按鈕文字變更為「▲ 收起」

#### Scenario: 點擊收起增量設定
- **WHEN** 增量設定區域為展開狀態且使用者點擊「▲ 收起」按鈕
- **THEN** 系統收起增量設定區域，隱藏分鐘和秒數輸入欄位
- **AND** 按鈕文字變更為「⚙️ 設定增量 (目前：X分Y秒)」

#### Scenario: 收起狀態下顯示目前設定值
- **WHEN** 增量設定區域為收起狀態
- **THEN** 按鈕顯示「⚙️ 設定增量 (目前：X分Y秒)」，其中 X 和 Y 為目前的增量分鐘和秒數

#### Scenario: 展開狀態下顯示收起文字
- **WHEN** 增量設定區域為展開狀態
- **THEN** 按鈕顯示「▲ 收起」

### Requirement: 預設狀態為收起
系統 SHALL 在頁面首次載入時，將增量設定區域設為收起狀態，除非 localStorage 中有儲存的展開偏好。

#### Scenario: 首次載入頁面
- **WHEN** 使用者首次開啟頁面且 localStorage 無展開狀態記錄
- **THEN** 增量設定區域為收起狀態
- **AND** 按鈕顯示「⚙️ 設定增量 (目前：X分Y秒)」

#### Scenario: 載入頁面時恢復上次狀態
- **WHEN** 使用者重新開啟頁面且 localStorage 有儲存展開狀態
- **THEN** 系統恢復上次的展開/收起狀態

### Requirement: 取消連續沖泡時自動收起設定區域
系統 SHALL 在使用者取消勾選「啟用連續沖泡」時，自動收起增量設定區域（如果展開的話）。

#### Scenario: 展開狀態下取消勾選連續沖泡
- **WHEN** 增量設定區域為展開狀態且使用者取消勾選「啟用連續沖泡」
- **THEN** 系統自動收起增量設定區域

#### Scenario: 收起狀態下取消勾選連續沖泡
- **WHEN** 增量設定區域為收起狀態且使用者取消勾選「啟用連續沖泡」
- **THEN** 增量設定區域保持收起狀態（無變化）

#### Scenario: 重新勾選連續沖泡
- **WHEN** 使用者重新勾選「啟用連續沖泡」
- **THEN** 增量設定區域保持之前的展開/收起狀態（不自動展開）

### Requirement: 展開/收起按鈕僅在連續沖泡啟用時顯示
系統 SHALL 僅在連續沖泡模式啟用時顯示展開/收起按鈕。

#### Scenario: 啟用連續沖泡時顯示按鈕
- **WHEN** 使用者勾選「啟用連續沖泡」
- **THEN** 系統在連續沖泡區域右上角顯示展開/收起按鈕

#### Scenario: 未啟用連續沖泡時隱藏按鈕
- **WHEN** 使用者未勾選「啟用連續沖泡」
- **THEN** 系統不顯示展開/收起按鈕

### Requirement: 保持增量輸入功能不變
系統 SHALL 在展開狀態下保持原有的增量輸入功能，包括範圍驗證和數值限制。

#### Scenario: 展開後輸入增量分鐘
- **WHEN** 增量設定區域展開且使用者在分鐘欄位輸入數值
- **THEN** 系統按照原有邏輯驗證範圍（0-10）並更新狀態

#### Scenario: 展開後輸入增量秒數
- **WHEN** 增量設定區域展開且使用者在秒數欄位輸入數值
- **THEN** 系統按照原有邏輯驗證範圍（0-59）並更新狀態

#### Scenario: 收起狀態不影響增量值
- **WHEN** 增量設定區域為收起狀態
- **THEN** 增量分鐘和秒數的數值保持不變，不因收起而重置
