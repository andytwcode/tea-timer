# input-validation

## Purpose

定義輸入驗證邏輯、錯誤訊息顯示和視覺回饋的規格，確保使用者輸入的值合法且提供明確的錯誤回饋。

## Requirements

### Requirement: 驗證第一泡分鐘數範圍
系統 SHALL 驗證第一泡分鐘數必須在 0 到 10 之間，並在超出範圍時顯示錯誤訊息。

#### Scenario: 輸入負數分鐘
- **WHEN** 使用者輸入負數分鐘（如 -1）
- **THEN** 系統顯示錯誤訊息「分鐘數不可為負數」
- **AND** 分鐘輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入超過上限的分鐘數
- **WHEN** 使用者輸入大於 10 的分鐘數（如 15）
- **THEN** 系統顯示錯誤訊息「分鐘數不可超過 10」
- **AND** 分鐘輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入有效分鐘數
- **WHEN** 使用者輸入 0 到 10 之間的分鐘數
- **THEN** 系統不顯示錯誤訊息
- **AND** 分鐘輸入欄位顯示正常邊框

### Requirement: 驗證第一泡秒數範圍
系統 SHALL 驗證第一泡秒數必須在 0 到 59 之間，並在超出範圍時顯示錯誤訊息。

#### Scenario: 輸入負數秒數
- **WHEN** 使用者輸入負數秒數（如 -30）
- **THEN** 系統顯示錯誤訊息「秒數不可為負數」
- **AND** 秒數輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入超過上限的秒數
- **WHEN** 使用者輸入大於 59 的秒數（如 90）
- **THEN** 系統顯示錯誤訊息「秒數不可超過 59」
- **AND** 秒數輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入有效秒數
- **WHEN** 使用者輸入 0 到 59 之間的秒數
- **THEN** 系統不顯示錯誤訊息
- **AND** 秒數輸入欄位顯示正常邊框

### Requirement: 驗證第一泡總時間
系統 SHALL 驗證第一泡總時間（分鐘 × 60 + 秒）必須在 5 秒到 600 秒之間，在欄位值都合法但總時間不符時顯示錯誤。

#### Scenario: 總時間少於 5 秒
- **WHEN** 使用者輸入 0 分鐘 3 秒
- **THEN** 系統顯示錯誤訊息「第一泡時間必須在 5 秒到 10 分鐘之間」
- **AND** 分鐘和秒數欄位都顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 總時間為 5 秒（邊界值）
- **WHEN** 使用者輸入 0 分鐘 5 秒
- **THEN** 系統不顯示錯誤訊息
- **AND** 開始按鈕可用

#### Scenario: 總時間為 600 秒（邊界值）
- **WHEN** 使用者輸入 10 分鐘 0 秒
- **THEN** 系統不顯示錯誤訊息
- **AND** 開始按鈕可用

#### Scenario: 總時間超過 600 秒
- **WHEN** 使用者輸入 10 分鐘 1 秒
- **THEN** 系統顯示錯誤訊息「第一泡時間必須在 5 秒到 10 分鐘之間」
- **AND** 分鐘和秒數欄位都顯示紅框標示
- **AND** 開始按鈕被禁用

### Requirement: 驗證增量分鐘數
系統 SHALL 在連續沖泡模式啟用時驗證增量分鐘數必須大於等於 0。

#### Scenario: 輸入負數增量分鐘
- **WHEN** 連續沖泡模式啟用且使用者輸入負數增量分鐘（如 -1）
- **THEN** 系統在增量區域顯示錯誤訊息「增量分鐘數不可為負數」
- **AND** 增量分鐘輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入有效增量分鐘
- **WHEN** 連續沖泡模式啟用且使用者輸入 0 或正數增量分鐘
- **THEN** 系統不顯示增量錯誤訊息
- **AND** 增量分鐘輸入欄位顯示正常邊框

#### Scenario: 連續沖泡未啟用時不驗證增量
- **WHEN** 連續沖泡模式未啟用
- **THEN** 系統不驗證增量時間
- **AND** 即使增量欄位有無效值也不影響開始按鈕

### Requirement: 驗證增量秒數
系統 SHALL 在連續沖泡模式啟用時驗證增量秒數必須大於等於 0。

#### Scenario: 輸入負數增量秒數
- **WHEN** 連續沖泡模式啟用且使用者輸入負數增量秒數（如 -30）
- **THEN** 系統在增量區域顯示錯誤訊息「增量秒數不可為負數」
- **AND** 增量秒數輸入欄位顯示紅框標示
- **AND** 開始按鈕被禁用

#### Scenario: 輸入有效增量秒數
- **WHEN** 連續沖泡模式啟用且使用者輸入 0 或正數增量秒數
- **THEN** 系統不顯示增量錯誤訊息
- **AND** 增量秒數輸入欄位顯示正常邊框

### Requirement: 錯誤訊息優先級
系統 SHALL 按照優先級顯示錯誤訊息，只顯示最高優先級的一個錯誤。

#### Scenario: 同時有欄位級別和總時間錯誤
- **WHEN** 分鐘為負數且總時間也不符
- **THEN** 系統只顯示「分鐘數不可為負數」（欄位錯誤優先）

#### Scenario: 只有總時間錯誤
- **WHEN** 欄位值都合法但總時間為 3 秒
- **THEN** 系統顯示「第一泡時間必須在 5 秒到 10 分鐘之間」

#### Scenario: 同時有第一泡和增量錯誤
- **WHEN** 分鐘為負數且增量秒數也為負數
- **THEN** 系統主要錯誤區域顯示「分鐘數不可為負數」
- **AND** 增量區域顯示「增量秒數不可為負數」

### Requirement: 視覺錯誤標示
系統 SHALL 為無效欄位顯示紅色邊框，為合法欄位顯示正常邊框。

#### Scenario: 無效欄位顯示紅框
- **WHEN** 欄位值不符合驗證規則
- **THEN** 輸入欄位邊框顯示為紅色（border-red-400）
- **AND** focus 時 ring 顯示為紅色（focus:ring-red-200）

#### Scenario: 合法欄位顯示正常邊框
- **WHEN** 欄位值符合驗證規則
- **THEN** 輸入欄位邊框顯示為灰色/綠色（border-gray-200 或 border-green-200）
- **AND** focus 時 ring 顯示為綠色（focus:ring-green-200）

#### Scenario: 修正錯誤後紅框消失
- **WHEN** 使用者修正無效值為合法值
- **THEN** 紅框即時消失，恢復正常邊框

### Requirement: 開始按鈕根據驗證結果啟用/禁用
系統 SHALL 在有任何驗證錯誤時禁用開始按鈕，所有驗證通過時啟用按鈕。

#### Scenario: 有錯誤時按鈕禁用
- **WHEN** 存在任何驗證錯誤（欄位、總時間或增量）
- **THEN** 開始按鈕被禁用
- **AND** 按鈕顯示為灰色（disabled 樣式）
- **AND** 游標顯示為 not-allowed

#### Scenario: 無錯誤時按鈕可用
- **WHEN** 所有驗證都通過
- **THEN** 開始按鈕可點擊
- **AND** 按鈕顯示為綠色漸層（正常樣式）

#### Scenario: 計時中按鈕不受驗證影響
- **WHEN** 計時器正在運行（包含暫停狀態）
- **THEN** 按鈕保持可用（顯示暫停/繼續）
- **AND** 驗證狀態不影響按鈕可用性
